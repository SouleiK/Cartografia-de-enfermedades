"0","set.seed(1)"
"0",""
"0",""
"0","# Bayes"
"0",""
"0","model <- function() {"
"0","  for (i in 1:n) {"
"0","    O[i] ~ dpois(mu[i])"
"0","    log(mu[i]) <- log(E[i]) + m + het[i] + sp[i]"
"0","    het[i] ~ dnorm(0, prechet)"
"0","    R[i] <- exp(m + het[i] + sp[i])"
"0","  }"
"0","  for (i in 1:n) {"
"0","    p.r[i] <- step(R[i] - 1)"
"0","  }"
"0",""
"0","  sp[1:n] ~ car.normal(adj[], w[], num[], precsp)"
"0","  m ~ dflat()"
"0","  prechet <- pow(sdhet, -2)"
"0","  precsp <- pow(sdsp, -2)"
"0","  sdhet ~ dunif(0, 10)"
"0","  sdsp ~ dunif(0, 10)"
"0",""
"0","  # dist predictiva"
"0","  for (i in 1:n) {"
"0","    y.pred[i] ~ dpois(mu[i])"
"0","    res[i] <- y.pred[i] - O[i]"
"0","    p.res[i] <- step(res[i])"
"0","    p.y[i] <- step(y.pred[i])"
"0","  }"
"0","}"
"0",""
"0",""
"0","datos <- list("
"0","  O = Aragon.df$O,"
"0","  E = Aragon.df$E,"
"0","  n = 729,"
"0","  adj = vecinos$adj,"
"0","  w = vecinos$weights,"
"0","  num = vecinos$num"
"0",")"
"0",""
"0","iniciales <- function() {"
"0","  list(m = rnorm(1), "
"0","       het = rnorm(729, 0, 0.1), "
"0","       sp = rnorm(729, 0, 0.1), "
"0","       sdhet = runif(1, 0, 1), "
"0","       sdsp = runif(1, 0, 1), "
"0","       y.pred = rpois(729, mean(Aragon.df$O)))"
"0","}"
"0","param <- c(""R"", ""m"", ""het"", ""sp"", ""sdhet"", ""sdsp"", ""p.r"", ""p.res"", ""y.pred"", ""p.y"")"
"0",""
"0",""
"0","tic(""Modelo Winbugs"")"
"0","mod <- bugs("
"0","  data = datos,"
"0","  inits = iniciales,"
"0","  parameters = param,"
"0","  model = model,"
"0","  n.iter = 2000, "
"0","  n.burnin = 200, "
"0","  n.thin = 3"
"0","  , debug=TRUE"
"0",")"
"0","toc()"
"1","Modelo Winbugs: 154.97 sec elapsed
"
"0","(mod$DIC)"
"1","[1]"
"1"," 1895.06"
"1","
"
